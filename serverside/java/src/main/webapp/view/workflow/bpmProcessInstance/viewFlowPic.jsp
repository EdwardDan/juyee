<%@ page contentType="text/html;charset=UTF-8" pageEncoding="UTF-8" %><%@ include file="/common/taglibs.jsp" %><html xmlns:v="urn:schemas-microsoft-com:vml"      xmlns="http://www.w3.org/TR/REC-html40"><head>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>    <meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5"/>    <!--<link rel="stylesheet" type="text/css" href="visio.css"/>-->    <title>${bean.name}（蓝色部分为当前所处任务节点）</title>    <%@include file="/common/header.jsp" %>    <style type="text/css">        v\:* { behavior: url(#default#VML); }    </style>    <script type="text/jscript" language="jscript">        //初始化操作：加载变化样式、设置底图链接、放大当前图片        var currentObj = null;        function init()        {            for(var i=0;i<document.all.length;i++)            {                var obj = document.all[i];                if(obj.tagName == "group" && obj.id == "ConvertedImage")                {                    obj.style.visibility = "visible";                    break;                }            }            //加载变化样式            loadDefaultChangeStyle();            //放大当前图片            var maxWidth = 900;    //显示最大宽度            var groupObj = getGroupObj();            var groupObj_width = groupObj.style.pixelWidth;            var groupObj_height = groupObj.style.pixelHeight;//            alert(groupObj_width+":"+groupObj_height);            var pageWidth = document.body.clientWidth;            if(pageWidth<maxWidth) maxWidth = pageWidth;//            alert(maxWidth+":"+groupObj_width);            if(maxWidth<groupObj_width){                maxWidth = groupObj_width;                document.body.style.overflowX = "auto";            }else{                groupObj.style.pixelWidth = roundNumber(groupObj_width*(maxWidth/groupObj_width),0)-20;                groupObj.style.pixelHeight = roundNumber(groupObj_height*(maxWidth/groupObj_width),0)-20;                document.body.style.overflowX = "hidden";            }            //高亮显示当前所处任务节点            var shapeObj = getShapeObj("shape", "${taskShapeId}");            if(currentObj == null){                currentObj = shapeObj;            }            changeShapeTyleTime(shapeObj);            //高亮显示所属泳道            changeShapeTyle(getShapeObj("swimline", "${swimlaneShapeId}"));        }        //加载节点颜色定义        function loadDefaultChangeStyle()        {            if(document.all)            {                var shape = '<v:shapetype id="VISSHAPE_NEW" target="_parent" coordsize="2847,2000" coordorigin="-1000,-1000" filled="t" fillcolor="blue" stroked="t" strokecolor="blue" strokeweight="1"><v:fill opacity="0.3"/></v:shapetype>';                document.all.VMLDiv.innerHTML = document.all.VMLDiv.innerHTML+shape;            }        }        //改变节点颜色        function changeShapeTyle(obj)        {            if(obj != null)            {                obj.type = "#VISSHAPE_NEW";            }        }        //改变节点颜色        function changeShapeTyleTime()        {            var obj = currentObj;            if(obj != null)            {                var s = obj.type+"";                if(s.indexOf("VISSHAPE_NE")>-1)                {                    obj.type = "#VISSHAPE";                }else{                    obj.type = "#VISSHAPE_NEW";                }                window.setTimeout("changeShapeTyleTime();",300);            }        }        //获取group        function getGroupObj()        {            var retObj = null;            for(var i=0;i<document.all.length;i++)            {                var obj = document.all[i];                if(obj.tagName == "group" && obj.id != "")                {                    retObj = obj;                    break;                }            }            return retObj;        }        //根据shapeID获取所在节点(泳道或者任务节点)        function getShapeObj(shapeType,shapeID)        {            var clickFunctionName = "*";            if("shape" == shapeType){               clickFunctionName = "OnShapeClick";             }else if("swimline" == shapeType){               clickFunctionName = "OnSwimlineClick";            }            var retObj = null;            try{                for(var i=0;i<document.all.length;i++)                {                    var obj = document.all[i];                    //因无法产生title，所以取消title判断条件                    if (obj.tagName == "shape" && obj.onclick != null)                    {                        var onclickStr = obj.onclick+"";                        var str = ","+shapeID+")";                        if(onclickStr.indexOf(clickFunctionName)>-1 && onclickStr.indexOf(str)>-1)                        {                            retObj = obj;                            break;                        }                    }                }            }catch(e){}            return retObj;        }        //获取imagedata        function getImagedataObj()        {            var retObj = null;            for(var i=0;i<document.all.length;i++)            {                var obj = document.all[i];                if(obj.tagName == "imagedata" && obj.src != "")                {                    retObj = obj;                    break;                }            }            return retObj;        }        function UpdateTooltip(obj,pageID,shapeID)        {        }        function OnShapeClick(pageID,shapeID)        {        }        function OnSwimlineClick(pageID,shapeID)        {                    }                    </script></head><body style="MARGIN:10px" onload="init()"><div id="VMLDiv" >    <!-- 替换内容 begin -->    ${vmlHtml}    <!-- 替换内容 end --></div></body></html>